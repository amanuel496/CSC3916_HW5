(this["webpackJsonpcsc3916-hw5"]=this["webpackJsonpcsc3916-hw5"]||[]).push([[0],{70:function(e,t,n){},71:function(e,t,n){},85:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),s=n(21),o=n.n(s),c=(n(70),n(71),n(15)),r=n(16),l=n(19),u=n(17),d=n(96),j=n(97),h=n(33),b=n(11),p={USER_LOGGEDIN:"USER_LOGGEDIN",USER_LOGOUT:"USER_LOGOUT",FETCH_MOVIES:"FETCH_MOVIES",FETCH_MOVIE:"FETCH_MOVIE",SET_MOVIE:"SET_MOVIE",NEW_POST:"NEW_POST"},O=n(25),v=n.n(O);function m(e){v()();return function(t){return fetch("https://hw5-amanuel.herokuapp.com/users/signin",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e),mode:"cors"}).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(n){var a;localStorage.setItem("username",e.username),localStorage.setItem("token",n.token),t((a=e.username,{type:p.USER_LOGGEDIN,username:a}))})).catch((function(e){return console.log(e)}))}}function g(){return function(e){localStorage.removeItem("username"),localStorage.removeItem("token"),e({type:p.USER_LOGOUT})}}var x=n(2),f=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"logout",value:function(){this.props.dispatch(g())}},{key:"render",value:function(){return Object(x.jsx)("div",{children:Object(x.jsxs)(d.a,{expand:"lg",bg:"dark",variant:"dark",children:[Object(x.jsx)(d.a.Brand,{children:"Movie App"}),Object(x.jsx)(d.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(x.jsx)(d.a.Collapse,{id:"basic-navbar-nav",children:Object(x.jsxs)(j.a,{children:[Object(x.jsx)(h.LinkContainer,{to:"/movielist",children:Object(x.jsx)(j.a.Link,{disabled:!this.props.loggedIn,children:"Movie List"})}),Object(x.jsx)(h.LinkContainer,{to:"/movie/"+(this.props.selectedMovie?this.props.selectedMovie._id:""),children:Object(x.jsx)(j.a.Link,{disabled:!this.props.loggedIn,children:"Movie Detail"})}),Object(x.jsx)(h.LinkContainer,{to:"/signin",children:Object(x.jsx)(j.a.Link,{children:this.props.loggedIn?Object(x.jsx)("button",{onClick:this.logout.bind(this),children:"Logout"}):"Login"})})]})})]})})}}]),n}(a.Component),y=Object(b.b)((function(e){return{loggedIn:e.auth.loggedIn,username:e.auth.username,selectedMovie:e.movie.selectedMovie}}))(f),k=n(13);function S(e){return function(t){t(function(e){return{type:p.SET_MOVIE,selectedMovie:e}}(e))}}function I(e){v()();return function(t){return fetch("{https://hw5-amanuel.herokuapp.com/movies/".concat(e,"?review=true"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:localStorage.getItem("token")},mode:"cors"}).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(e){t({type:p.FETCH_MOVIE,selectedMovie:e})})).catch((function(e){return console.log(e)}))}}function E(){v()();return function(e){return fetch("https://hw5-amanuel.herokuapp.com/movies?review=true",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:localStorage.getItem("token")},mode:"cors"}).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(t){var n;e((n=(n=t).Movielist,console.log(n),{type:p.FETCH_MOVIES,movies:n}))})).catch((function(e){return console.log(e)}))}}var C=n(90),w=n(95),M=n(39),T=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).handleClick=function(e){(0,a.props.dispatch)(S(e))},a.handleSelect=a.handleSelect.bind(Object(k.a)(a)),a}return Object(r.a)(n,[{key:"componentDidMount",value:function(){(0,this.props.dispatch)(E())}},{key:"handleSelect",value:function(e,t){(0,this.props.dispatch)(S(this.props.movies[e]))}},{key:"render",value:function(){var e=this,t=function(t){var n=t.movieList;return n?Object(x.jsx)(w.a,{onSelect:e.handleSelect,children:n.map((function(t){return Object(x.jsxs)(w.a.Item,{children:[Object(x.jsx)("div",{children:Object(x.jsx)(h.LinkContainer,{to:"/movie/"+t._id,onClick:function(){return e.handleClick(t)},children:Object(x.jsx)(j.a.Link,{children:Object(x.jsx)(C.a,{className:"image",src:t.imageUrl,thumbnail:!0})})})}),Object(x.jsxs)(w.a.Caption,{children:[Object(x.jsx)("h3",{children:t.title}),Object(x.jsx)(M.a,{glyph:"star"})," ",t.ratingAvg," ","\xa0\xa0 ",t.yearReleased]})]},t._id)}))}):Object(x.jsx)("div",{children:"Loading...."})};return Object(x.jsx)(t,{movieList:this.props.movies})}}]),n}(a.Component),L=Object(b.b)((function(e){return{movies:e.movie.movies}}))(T),_=n(65),D=n(7),N=n(98),G=n(91),R=n(61),U=n(94),F=n(92),P=n(93),V=n(62),A=n(63),H=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).updateDetails=a.updateDetails.bind(Object(k.a)(a)),a.submit=a.submit.bind(Object(k.a)(a)),a.handleSelect=a.handleSelect.bind(Object(k.a)(a)),a.state={details:{rating:void 0,quote:void 0}},a}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;void 0==this.props.selectedMovie&&e(I(this.props.movieId))}},{key:"shouldComponentUpdate",value:function(e,t){return this.props.number!==e.number}},{key:"updateDetails",value:function(e){var t=Object.assign({},this.state.details);t[e.target.name]=e.target.value,this.setState({details:t})}},{key:"handleSelect",value:function(e){var t=Object.assign({},this.state.details);t.rating=parseInt(e),this.setState({details:t}),console.log(this.state.details)}},{key:"submit",value:function(){var e,t;(0,this.props.dispatch)((e=this.state.details,t=this.props.movieId,function(n){v()(),window.localStorage.getItem("token"),e.movie=t,console.log(e),fetch("https://hw4-amanuel.herokuapp.com/reviews",{method:"POST",headers:{"content-type":"application/json",Authorization:"JWT ".concat(localStorage.getItem("token"))},mode:"cors",body:JSON.stringify(e)}).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(e){return n({type:p.NEW_POST,movieId:t})}))}))}},{key:"render",value:function(){var e=this,t=function(){return e.props.selectedMovie?Object(x.jsxs)(N.a,{children:[Object(x.jsx)(N.a.Header,{children:"Movie Detail"}),Object(x.jsx)(N.a.Body,{children:Object(x.jsx)(C.a,{className:"image",src:e.props.selectedMovie.imageUrl,thumbnail:!0})}),Object(x.jsxs)(G.a,{children:[Object(x.jsx)(R.a,{children:e.props.selectedMovie.title}),Object(x.jsx)(R.a,{children:e.props.selectedMovie.actors.map((function(e,t){return Object(x.jsxs)("p",{children:[Object(x.jsx)("b",{children:e.actorName})," ",e.characterName]},t)}))}),Object(x.jsx)(R.a,{children:Object(x.jsxs)("h4",{children:[Object(x.jsx)(M.a,{})," ",e.props.selectedMovie.ratingAvg]})})]}),Object(x.jsx)(N.a.Body,{children:e.props.selectedMovie.review.map((function(e,t){return Object(x.jsxs)("p",{children:[Object(x.jsx)("b",{children:e.nameOfReviewer}),"\xa0 ",e.quote,"\xa0 ",Object(x.jsx)(M.a,{})," ",e.rating]},t)}))}),Object(x.jsx)(N.a.Body,{children:Object(x.jsxs)(U.a,{className:"review-form",onSubmit:e.submit,children:[Object(x.jsxs)(U.a.Group,{controlId:"exampleForm.ControlTextarea1",children:[Object(x.jsx)(U.a.Label,{children:"Comment"}),Object(x.jsx)(U.a.Control,{id:"text-field",name:"quote",onChange:e.updateDetails,value:e.state.details.quote,as:"textarea",rows:2,cols:1})]}),Object(x.jsx)("fieldset",{children:Object(x.jsx)(U.a.Group,{as:F.a,children:Object(x.jsxs)(P.a,{className:"rating-btn",drop:"up",onSelect:e.handleSelect,value:e.state.details.rating,children:[Object(x.jsx)(P.a.Toggle,{variant:"Secondary",id:"dropdown-basic",children:"Rating"}),Object(x.jsxs)(P.a.Menu,{children:[Object(x.jsx)(P.a.Item,{eventKey:"1",children:"1"}),Object(x.jsx)(P.a.Item,{eventKey:"2",children:"2"}),Object(x.jsx)(P.a.Item,{eventKey:"3",children:"3"}),Object(x.jsx)(P.a.Item,{eventKey:"4",children:"4"}),Object(x.jsx)(P.a.Item,{eventKey:"5",children:"5"})]})]})})}),Object(x.jsx)(U.a.Group,{as:F.a,children:Object(x.jsx)(V.a,{sm:{span:1,offset:0},children:Object(x.jsx)(A.a,{className:"submit-btn",type:"submit",onSubmit:e.submit,children:"Submit"})})})]})})]}):Object(x.jsx)("div",{children:"Loading...."})};return Object(x.jsx)(t,{})}}]),n}(a.Component),B=Object(b.b)((function(e){return{selectedMovie:e.movie.selectedMovie}}))(H);var J=function(e){var t=Object(a.useState)(e.selectedMovie),n=Object(_.a)(t,1)[0],i=Object(D.m)().movieId;console.log(i);var s=Object(b.c)();return null==n&&s(I(i)),Object(x.jsx)(B,{movieId:i})},z=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).updateDetails=a.updateDetails.bind(Object(k.a)(a)),a.login=a.login.bind(Object(k.a)(a)),a.state={details:{username:"",password:""}},a}return Object(r.a)(n,[{key:"updateDetails",value:function(e){var t=Object.assign({},this.state.details);t[e.target.id]=e.target.value,this.setState({details:t})}},{key:"login",value:function(){(0,this.props.dispatch)(m(this.state.details))}},{key:"render",value:function(){return Object(x.jsxs)(U.a,{className:"form-horizontal",children:[Object(x.jsxs)(U.a.Group,{controlId:"username",children:[Object(x.jsx)(U.a.Label,{children:"Email"}),Object(x.jsx)(U.a.Control,{onChange:this.updateDetails,value:this.state.details.username,type:"email",placeholder:"Enter email"})]}),Object(x.jsxs)(U.a.Group,{controlId:"password",children:[Object(x.jsx)(U.a.Label,{children:"Password"}),Object(x.jsx)(U.a.Control,{onChange:this.updateDetails,value:this.state.details.password,type:"password",placeholder:"Password"})]}),Object(x.jsx)(A.a,{onClick:this.login,children:"Sign in"})]})}}]),n}(a.Component),K=Object(b.b)((function(e){return{}}))(z),W=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).updateDetails=a.updateDetails.bind(Object(k.a)(a)),a.register=a.register.bind(Object(k.a)(a)),a.state={details:{name:"",username:"",password:""}},a}return Object(r.a)(n,[{key:"updateDetails",value:function(e){var t=Object.assign({},this.state.details);t[e.target.id]=e.target.value,this.setState({details:t})}},{key:"register",value:function(){var e;(0,this.props.dispatch)((e=this.state.details,v()(),function(t){return fetch("https://hw5-amanuel.herokuapp.com/users/signup",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e),mode:"cors"}).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(n){t(m(e))})).catch((function(e){return console.log(e)}))}))}},{key:"render",value:function(){return Object(x.jsxs)(U.a,{className:"form-horizontal",children:[Object(x.jsxs)(U.a.Group,{controlId:"name",children:[Object(x.jsx)(U.a.Label,{children:"Name"}),Object(x.jsx)(U.a.Control,{onChange:this.updateDetails,value:this.state.details.name,type:"text",placeholder:"Name"})]}),Object(x.jsxs)(U.a.Group,{controlId:"username",children:[Object(x.jsx)(U.a.Label,{children:"Email"}),Object(x.jsx)(U.a.Control,{onChange:this.updateDetails,value:this.state.details.username,type:"email",placeholder:"Enter email"})]}),Object(x.jsxs)(U.a.Group,{controlId:"password",children:[Object(x.jsx)(U.a.Label,{children:"Password"}),Object(x.jsx)(U.a.Control,{onChange:this.updateDetails,value:this.state.details.password,type:"password",placeholder:"Password"})]}),Object(x.jsx)(A.a,{onClick:this.register,children:"Register"})]})}}]),n}(a.Component),q=Object(b.b)((function(e){return{}}))(W),Q=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).state={toggleReg:!1},e}return Object(r.a)(n,[{key:"componentDidMount",value:function(){}},{key:"showLogin",value:function(){this.setState({toggleReg:!1})}},{key:"showReg",value:function(){this.setState({toggleReg:!0})}},{key:"logout",value:function(){this.props.dispatch(g())}},{key:"render",value:function(){var e=Object(x.jsxs)("div",{children:[Object(x.jsx)("button",{onClick:this.showLogin.bind(this),children:"Login"}),Object(x.jsx)("button",{onClick:this.showReg.bind(this),children:"Register"}),this.state.toggleReg?Object(x.jsx)(q,{}):Object(x.jsx)(K,{})]}),t=Object(x.jsxs)("div",{children:["Logged in as: ",this.props.username," ",Object(x.jsx)("button",{onClick:this.logout.bind(this),children:"Logout"})]});return Object(x.jsx)("div",{children:this.props.loggedIn?t:e})}}]),n}(a.Component),X=Object(b.b)((function(e){return{loggedIn:e.auth.loggedIn,username:e.auth.username}}))(Q),Y=n(35),Z=n(34),$=n(64),ee={loggedIn:!!localStorage.getItem("token"),username:localStorage.getItem("username")?localStorage.getItem("username"):""},te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee,t=arguments.length>1?arguments[1]:void 0,n=Object.assign({},e);switch(t.type){case p.USER_LOGGEDIN:return n.loggedIn=!0,n.username=t.username,n;case p.USER_LOGOUT:return n.loggedIn=!1,n.username="",n;default:return e}},ne={movies:[],selectedMovie:null},ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ne,t=arguments.length>1?arguments[1]:void 0,n=Object.assign({},e);switch(t.type){case p.FETCH_MOVIES:return n.movies=t.movies,n.selectedMovie=t.movies[0],n;case p.SET_MOVIE:case p.FETCH_MOVIE:return n.selectedMovie=t.selectedMovie,n;default:return e}},ie={items:[],item:{}},se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0;t.movieId,Object.assign({},e);switch(t.type){case p.NEW_POST:default:return e}},oe=[$.a],ce=Object(Z.d)(Object(Z.c)({auth:te,movie:ae,review:se}),Z.a.apply(void 0,oe));var re=function(){return Object(x.jsx)("div",{className:"App",children:Object(x.jsx)(b.a,{store:ce,children:Object(x.jsx)(Y.HashRouter,{children:Object(x.jsxs)("div",{children:[Object(x.jsx)(y,{}),Object(x.jsx)(D.d,{exact:!0,path:"/",render:function(){return Object(x.jsx)(L,{})}}),Object(x.jsx)(D.d,{exact:!0,path:"/movielist",render:function(){return Object(x.jsx)(L,{})}}),Object(x.jsx)(D.d,{exact:!0,path:"/movie/:movieId",render:function(){return Object(x.jsx)(J,{})}}),Object(x.jsx)(D.d,{path:"/signin",render:function(){return Object(x.jsx)(X,{})}})]})})})})},le=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,99)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,s=t.getLCP,o=t.getTTFB;n(e),a(e),i(e),s(e),o(e)}))};o.a.render(Object(x.jsx)(i.a.StrictMode,{children:Object(x.jsx)(re,{})}),document.getElementById("root")),le()}},[[85,1,2]]]);
//# sourceMappingURL=main.dc2f4386.chunk.js.map